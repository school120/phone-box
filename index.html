<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Phone Box Checker (Mobile MVP)</title>
  <!-- Tailwind (CDN build for simplicity on GitHub Pages) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .card{ @apply bg-white rounded-2xl shadow p-4; }
    .btn{ @apply px-3 py-2 rounded-2xl border; }
    .btn-primary{ @apply bg-gray-900 text-white; }
  </style>
  <!-- CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <!-- React + ReactDOM (no build step) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- TensorFlow.js + MobileNet for embeddings -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.20.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@2.1.0"></script>
  <!-- OpenCV.js for perspective + edge detection -->
  <script src="https://docs.opencv.org/4.x/opencv.js"></script>
</head>
<body class="min-h-screen bg-gray-50 text-gray-900">
  <div id="root" class="p-4 sm:p-6"></div>

  <script type="text/javascript">
  // ===== React helpers =====
  const { useEffect, useRef, useState, useMemo } = React;

  const DEFAULT_GRID = { rows: 6, cols: 10 }; // 60 slots
  const STORAGE_KEYS = { roster: 'roster', grid: 'grid', assignments: 'assignments', gallery: 'gallery', corners: 'corners', box: 'currentBox' };
  const slotKey = (r,c)=> `${r}-${c}`;

  const Storage = {
    save: (k,v)=> localStorage.setItem(k, JSON.stringify(v)),
    load: (k,f)=> { try { const r = localStorage.getItem(k); return r? JSON.parse(r): f; } catch { return f; } }
  };

  const cosineSimilarity = (a,b)=>{
    if(!a||!b||a.length!==b.length) return 0; let dot=0,na=0,nb=0; for(let i=0;i<a.length;i++){ dot+=a[i]*b[i]; na+=a[i]*a[i]; nb+=b[i]*b[i]; } return dot/(Math.sqrt(na)*Math.sqrt(nb)+1e-8);
  };

  const downloadJson = (name, data)=>{
    const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
    const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download=name; a.click(); URL.revokeObjectURL(url);
  };

  function Header(){
    return (
      React.createElement('div',{className:'flex items-start justify-between gap-4'},[
        React.createElement('div',{key:1},[
          React.createElement('h1',{className:'text-2xl sm:text-3xl font-bold'},'Phone Box Checker (Mobile MVP)'),
          React.createElement('p',{className:'text-xs sm:text-sm text-gray-600'},'Use your phone to scan a box (6×10). Pick a box (9A–12F, SM1, SM2), auto‑assign from Security #, detect missing and flag possible fakes after enrollment.')
        ])
      ])
    );
  }

  function NumberInput({label,value,onChange,min=1,max=60}){
    return React.createElement('label',{className:'flex items-center gap-2'},[
      React.createElement('span',{className:'text-sm w-20'},label),
      React.createElement('input',{className:'border rounded px-2 py-1 w-24',type:'number',value, min, max, onChange:e=>onChange(Math.max(min, Math.min(max, parseInt(e.target.value||'0'))))})
    ]);
  }

  function RosterTable({ roster }){
    return React.createElement('div',{className:'overflow-auto max-h-64 border rounded'},[
      React.createElement('table',{className:'min-w-full text-sm'},[
        React.createElement('thead',{className:'bg-gray-100 sticky top-0'},[
          React.createElement('tr',{},[
            React.createElement('th',{className:'text-left p-2'},'Person ID'),
            React.createElement('th',{className:'text-left p-2'},'Full Name'),
            React.createElement('th',{className:'text-left p-2'},'Security #'),
            React.createElement('th',{className:'text-left p-2'},'Grade'),
            React.createElement('th',{className:'text-left p-2'},'Email')
          ])
        ]),
        React.createElement('tbody',{}, roster.map(r=>React.createElement('tr',{key:r.personId,className:'odd:bg-white even:bg-gray-50'},[
          React.createElement('td',{className:'p-2'},r.personId),
          React.createElement('td',{className:'p-2'},r.fullName),
          React.createElement('td',{className:'p-2'},r.securityNumber||''),
          React.createElement('td',{className:'p-2'},r.grade||''),
          React.createElement('td',{className:'p-2'},r.email||'')
        ])))
      ])
    ]);
  }

  // ==== Security Number parsing =====
  // Accept formats: 9B11, 10F7, 12C42, SM112, SM1-12, SM1 12
  function parseSecurityNumber(sn=''){
    const s = String(sn).trim().toUpperCase();
    if(!s) return null;
    // SM formats: SM1-12, SM1 12, SM112
    let m = s.match(/^\s*(SM\d+)\s*[- ]?\s*(\d{1,2})\s*$/);
    if(m) return { box: m[1], slot: parseInt(m[2],10) };
    // General: prefix + trailing 1–2 digits
    m = s.match(/^(.*?)(\d{1,2})$/);
    if(!m) return null;
    const box = m[1];
    const slot = parseInt(m[2],10);
    if(!(slot>=1 && slot<=60)) return null;
    return { box, slot };
  }

  function uniqueBoxesFromRoster(roster){
    const set = new Set();
    roster.forEach(r=>{ const p=parseSecurityNumber(r.securityNumber); if(p) set.add(p.box); });
    return Array.from(set).sort((a,b)=> a.localeCompare(b, undefined, {numeric:true}));
  }

  function AssignmentsPanel({ rows, cols, assignments, setAssignments, roster, currentBox }){
    const scopedRoster = useMemo(()=>{
      if(!currentBox) return roster;
      return roster.filter(r=>{ const p=parseSecurityNumber(r.securityNumber); return p && p.box===currentBox; });
    }, [roster, currentBox]);

    const [search, setSearch] = useState('');
    const filtered = scopedRoster.filter(r=> (r.fullName||'').toLowerCase().includes(search.toLowerCase()) || (r.securityNumber||'').toLowerCase().includes(search.toLowerCase()) || String(r.personId).includes(search));
    const slots = Array.from({length: rows*cols}, (_,i)=>({r: Math.floor(i/cols), c: i%cols}));

    const assign = (key,pid)=> setAssignments({...assignments, [key]: pid||undefined});

    const autoAssignFromSecurity = ()=>{
      if(!currentBox){ alert('Pick a box first.'); return; }
      const next = {...assignments};
      for(let r=0;r<rows;r++) for(let c=0;c<cols;c++){
        const key = slotKey(r,c); const slot = r*cols + c + 1; // 1..60
        const match = roster.find(stu=>{ const p=parseSecurityNumber(stu.securityNumber); return p && p.box===currentBox && p.slot===slot; });
        if(match) next[key] = String(match.personId);
      }
      setAssignments(next); alert('Auto‑assigned from Security # for '+currentBox);
    };

    return React.createElement('div',{className:'bg-white border rounded-xl p-3'},[
      React.createElement('div',{className:'flex items-center justify-between gap-3'},[
        React.createElement('h3',{className:'font-semibold'},`Assign students to slots ${currentBox? '('+currentBox+')':''}`),
        React.createElement('input',{className:'border rounded px-2 py-1 text-sm',placeholder:'Search roster',value:search,onChange:e=>setSearch(e.target.value)})
      ]),
      React.createElement('div',{className:'flex flex-wrap gap-2 mt-2'},[
        React.createElement('button',{className:'btn btn-primary',onClick:autoAssignFromSecurity},'Auto‑assign from Security #')
      ]),
      React.createElement('div',{className:'grid grid-cols-5 gap-2 mt-3'}, slots.map(({r,c})=>{
        const key = slotKey(r,c);
        const pid = assignments[key];
        const match = roster.find(x=>String(x.personId)===String(pid));
        const label = `#${r*cols+c+1}`;
        return React.createElement('div',{key,className:'border rounded-lg p-2 text-xs'},[
          React.createElement('div',{className:'text-[10px] text-gray-500'},label),
          React.createElement('div',{className:'font-medium truncate',title: match? match.fullName: 'Unassigned'}, match? match.fullName: 'Unassigned'),
          React.createElement('select',{className:'mt-1 w-full border rounded', value: pid||'', onChange:e=>assign(key,e.target.value)},[
            React.createElement('option',{key:'none',value:''},'— Assign —'),
            ...filtered.map(s=> React.createElement('option',{key:s.personId, value:s.personId},`${s.fullName} (${s.securityNumber||s.grade||''})`))
          ])
        ]);
      }))
    ]);
  }

  function App(){
    const [grid, setGrid] = useState(Storage.load(STORAGE_KEYS.grid, DEFAULT_GRID));
    const [roster, setRoster] = useState(Storage.load(STORAGE_KEYS.roster, []));
    const [assignments, setAssignments] = useState(Storage.load(STORAGE_KEYS.assignments, {}));
    const [gallery, setGallery] = useState(Storage.load(STORAGE_KEYS.gallery, {}));
    const [corners, setCorners] = useState(Storage.load(STORAGE_KEYS.corners, []));
    const [imageURL, setImageURL] = useState(null);
    const [presence, setPresence] = useState([]);
    const [results, setResults] = useState(null);
    const [mobilenetReady, setMobilenetReady] = useState(false);
    const [currentBox, setCurrentBox] = useState(Storage.load(STORAGE_KEYS.box, ''));
    const mobilenetRef = useRef(null);
    const canvasRef = useRef(null); const imgRef = useRef(null);

    // Persist
    useEffect(()=>Storage.save(STORAGE_KEYS.grid, grid),[grid]);
    useEffect(()=>Storage.save(STORAGE_KEYS.roster, roster),[roster]);
    useEffect(()=>Storage.save(STORAGE_KEYS.assignments, assignments),[assignments]);
    useEffect(()=>Storage.save(STORAGE_KEYS.gallery, gallery),[gallery]);
    useEffect(()=>Storage.save(STORAGE_KEYS.corners, corners),[corners]);
    useEffect(()=>Storage.save(STORAGE_KEYS.box, currentBox),[currentBox]);

    // Load MobileNet
    useEffect(()=>{ (async()=>{ try { mobilenetRef.current = await mobilenet.load({version:2, alpha:1.0}); setMobilenetReady(true);} catch(e){console.error(e);} })(); },[]);

    const parseRosterRows = (rows)=> rows.map(r=>({
      personId: String(r['Person ID']||r.personId||r.id||'').trim(),
      fullName: String(r['Full Name']||r.fullName||r.name||'').trim(),
      securityNumber: String(r['Security Number']||r.securityNumber||'').trim(),
      grade: String(r['Current Grade']||r.grade||'').trim(),
      email: String(r['Email 1']||r.email||'').trim(),
    })).filter(r=>r.personId && r.fullName);

    // Auto-load roster.csv on first visit / refresh
    useEffect(()=>{ (async()=>{
      try{
        const res = await fetch('roster.csv', {cache:'no-store'});
        if(res.ok){ const text = await res.text(); const parsed = Papa.parse(text, {header:true, skipEmptyLines:true}); const rows = parseRosterRows(parsed.data); if(rows && rows.length){ setRoster(rows); } }
      }catch(e){ /* ignore if not present */ }
    })(); },[]);

    const onUploadCSV = (file)=>{ Papa.parse(file, {header:true, skipEmptyLines:true, complete: (res)=>{ setRoster(parseRosterRows(res.data)); }}); };
    const onPhoto = (file)=>{ setImageURL(URL.createObjectURL(file)); setPresence([]); setResults(null); };

    const onClickCanvas = (e)=>{ if(!imageURL) return; const rect = e.currentTarget.getBoundingClientRect(); const x = e.clientX-rect.left; const y = e.clientY-rect.top; if(corners.length<4) setCorners([...corners,{x,y}]); };

    const analyze = async ()=>{
      if(!imageURL || corners.length!==4){ alert('Take/upload a photo and tap 4 corners (TL, TR, BR, BL)'); return; }
      if(!window.cv){ alert('OpenCV not loaded yet.'); return; }

      const img = imgRef.current; const canvas = canvasRef.current; const W = img.naturalWidth, H = img.naturalHeight; const ctx = canvas.getContext('2d'); canvas.width=W; canvas.height=H; ctx.drawImage(img,0,0,W,H);
      const cv = window.cv; const src = cv.imread(canvas); const dst = new cv.Mat();
      const srcTri = cv.matFromArray(4,1,cv.CV_32FC2, new Float32Array(corners.flatMap(p=>[p.x,p.y])));
      const dstTri = cv.matFromArray(4,1,cv.CV_32FC2, new Float32Array([0,0,W,0,W,H,0,H]));
      const M = cv.getPerspectiveTransform(srcTri, dstTri); cv.warpPerspective(src, dst, M, new cv.Size(W,H));

      const present=[]; const cellW=Math.floor(W/grid.cols), cellH=Math.floor(H/grid.rows);
      for(let r=0;r<grid.rows;r++) for(let c=0;c<grid.cols;c++){
        const x=c*cellW+Math.floor(cellW*0.08); const y=r*cellH+Math.floor(cellH*0.08); const cw=Math.floor(cellW*0.84), ch=Math.floor(cellH*0.84);
        const roi=new cv.Rect(x,y,cw,ch); const cell=dst.roi(roi);
        const gray=new cv.Mat(); cv.cvtColor(cell,gray,cv.COLOR_RGBA2GRAY); const blur=new cv.Mat(); cv.GaussianBlur(gray,blur,new cv.Size(3,3),0,0,cv.BORDER_DEFAULT); const edges=new cv.Mat(); cv.Canny(blur,edges,50,150);
        const density = cv.countNonZero(edges)/(cw*ch); present.push(density>0.02);
        gray.delete(); blur.delete(); edges.delete(); cell.delete();
      }
      setPresence(present);

      // Build results
      const missing=[]; const mismatched=[];
      if(mobilenetReady && mobilenetRef.current){
        const tf = window.tf; const model = mobilenetRef.current; const tmpCanvas = document.createElement('canvas'); const tctx=tmpCanvas.getContext('2d');
        let idx=0; for(let r=0;r<grid.rows;r++) for(let c=0;c<grid.cols;c++){
          const key = slotKey(r,c); const pid = assignments[key];
          if(!present[idx]){ if(pid) missing.push(pid); idx++; continue; }
          if(pid && gallery[pid]){
            const x=c*cellW+Math.floor(cellW*0.08); const y=r*cellH+Math.floor(cellH*0.08); const cw=Math.floor(cellW*0.84), ch=Math.floor(cellH*0.84);
            tmpCanvas.width=cw; tmpCanvas.height=ch; tctx.drawImage(cv.imshow('__tmp__',dst),x,y,cw,ch,0,0,cw,ch);
            const tensor=tf.browser.fromPixels(tmpCanvas).toFloat().div(255).expandDims(0);
            const emb = await model.infer(tensor,{embedding:true}).data();
            const sim = cosineSimilarity(Array.from(emb), gallery[pid]); if(sim<0.75) mismatched.push({personId: pid, sim, slot:key}); tf.dispose(tensor);
          }
          idx++;
        }
      }else{
        let idx=0; for(let r=0;r<grid.rows;r++) for(let c=0;c<grid.cols;c++){ const key=slotKey(r,c); if(!present[idx] && assignments[key]) missing.push(assignments[key]); idx++; }
      }

      src.delete(); dst.delete(); M.delete(); srcTri.delete(); dstTri.delete();
      setResults({missing, mismatched});
    };

    const enrollFromPhoto = async ()=>{
      if(!imageURL || corners.length!==4 || !mobilenetReady){ alert('Need photo + corners + model loaded'); return; }
      const img = imgRef.current; const canvas = canvasRef.current; const W=img.naturalWidth, H=img.naturalHeight; const ctx=canvas.getContext('2d'); canvas.width=W; canvas.height=H; ctx.drawImage(img,0,0,W,H);
      const cv=window.cv; const src=cv.imread(canvas); const dst=new cv.Mat(); const srcTri=cv.matFromArray(4,1,cv.CV_32FC2,new Float32Array(corners.flatMap(p=>[p.x,p.y]))); const dstTri=cv.matFromArray(4,1,cv.CV_32FC2,new Float32Array([0,0,W,0,W,H,0,H])); const M=cv.getPerspectiveTransform(srcTri,dstTri); cv.warpPerspective(src,dst,M,new cv.Size(W,H));
      const tf=window.tf; const model=mobilenetRef.current; const cellW=Math.floor(W/grid.cols), cellH=Math.floor(H/grid.rows); const can=document.createElement('canvas'); const c2d=can.getContext('2d'); const newGallery={...gallery};
      for(let r=0;r<grid.rows;r++) for(let c=0;c<grid.cols;c++){ const key=slotKey(r,c); const pid=assignments[key]; if(!pid) continue; const x=c*cellW+Math.floor(cellW*0.08); const y=r*cellH+Math.floor(cellH*0.08); const cw=Math.floor(cellW*0.84), ch=Math.floor(cellH*0.84); can.width=cw; can.height=ch; c2d.drawImage(cv.imshow('__en__',dst),x,y,cw,ch,0,0,cw,ch); const t=tf.browser.fromPixels(can).toFloat().div(255).expandDims(0); const emb=await model.infer(t,{embedding:true}).data(); newGallery[pid]=Array.from(emb); tf.dispose(t); }
      src.delete(); dst.delete(); M.delete(); srcTri.delete(); dstTri.delete(); setGallery(newGallery); alert('Enrollment complete: gallery updated.');
    };

    const boxes = uniqueBoxesFromRoster(roster);
    const rosterById = useMemo(()=> Object.fromEntries(roster.map(r=>[String(r.personId), r])), [roster]);

    return React.createElement('div',{className:'max-w-6xl mx-auto space-y-5'},[
      React.createElement(Header,{}),

      React.createElement('div',{className:'card'},[
        React.createElement('h2',{className:'text-lg font-semibold mb-3'},'1) Roster (auto‑loads from roster.csv)'),
        React.createElement('div',{className:'flex flex-wrap items-center gap-2 text-sm'},[
          React.createElement('label',{className:'btn'},['Upload CSV', React.createElement('input',{type:'file',accept:'.csv',className:'hidden',onChange:e=>{ const f=e.target.files?.[0]; if(f) onUploadCSV(f); }})]),
          React.createElement('a',{href:'roster.csv',className:'btn',download:true},'Download current roster.csv'),
          React.createElement('span',{className:'text-xs text-gray-500'},'Place roster.csv at the repo root (private repo recommended).')
        ]),
        roster.length? React.createElement(RosterTable,{roster}): React.createElement('div',{className:'text-sm text-gray-500 mt-3'},'No roster loaded yet. Put a roster.csv in the repo root or upload a CSV.')
      ]),

      React.createElement('div',{className:'card'},[
        React.createElement('h2',{className:'text-lg font-semibold mb-3'},'2) Pick box & grid'),
        React.createElement('div',{className:'flex items-center gap-3 flex-wrap'},[
          React.createElement('label',{className:'flex items-center gap-2'},[
            React.createElement('span',{className:'text-sm'},'Box'),
            React.createElement('select',{className:'border rounded px-2 py-1', value: currentBox, onChange:e=> setCurrentBox(e.target.value)}, [
              React.createElement('option',{key:'none',value:''},'— Select —'),
              ...boxes.map(b=> React.createElement('option',{key:b, value:b}, b))
            ])
          ]),
          React.createElement(NumberInput,{label:'Rows', value:grid.rows, onChange:v=>setGrid({...grid, rows:v}), min:1, max:12}),
          React.createElement(NumberInput,{label:'Cols', value:grid.cols, onChange:v=>setGrid({...grid, cols:v}), min:1, max:12}),
          React.createElement('div',{className:'text-xs text-gray-500'},`Total slots: ${grid.rows*grid.cols}`)
        ])
      ]),

      React.createElement('div',{className:'card'},[
        React.createElement('h2',{className:'text-lg font-semibold mb-3'},'3) Take picture (mobile‑friendly) & analyze'),
        React.createElement('div',{className:'flex flex-wrap items-center gap-2 text-sm'},[
          React.createElement('label',{className:'btn'},[
            'Take/Upload Photo',
            React.createElement('input',{type:'file',accept:'image/*',capture:'environment',className:'hidden',onChange:e=>{ const f=e.target.files?.[0]; if(f) onPhoto(f); }})
          ]),
          React.createElement('button',{className:'btn',onClick:()=>setCorners([])},'Reset corners'),
          React.createElement('button',{className:'btn btn-primary',onClick:analyze},'Analyze photo'),
          React.createElement('button',{className:'btn btn-primary',onClick:enrollFromPhoto, disabled:!mobilenetReady},'Enroll from this photo'),
          React.createElement('span',{className:'text-xs text-gray-500'},'Tap 4 corners (TL, TR, BR, BL).')
        ]),
        React.createElement('div',{className:'grid md:grid-cols-2 gap-4 mt-3'},[
          React.createElement('div',{className:'bg-gray-100 rounded-xl p-2'},[
            imageURL ? (
              React.createElement('div',{className:'relative'},[
                React.createElement('img',{src:imageURL, alt:'box', ref:imgRef, className:'w-full h-auto rounded'}),
                React.createElement('canvas',{ref:canvasRef, onClick:onClickCanvas, className:'mt-2 w-full border rounded'})
              ])
            ) : React.createElement('div',{className:'text-sm text-gray-500 p-8'},'Take a photo and tap the 4 corners to deskew. Then Analyze.')
          ]),
          React.createElement('div',{className:'space-y-4'},[
            React.createElement(AssignmentsPanel,{rows:grid.rows, cols:grid.cols, assignments, setAssignments, roster, currentBox}),
            presence.length>0 && React.createElement('div',{className:'bg-white border rounded-xl p-3 text-sm space-y-3'},[
              React.createElement('h3',{className:'font-semibold'},'Analysis Results'),
              (results && results.missing && results.missing.length) ? (
                React.createElement('div',{},[
                  React.createElement('div',{className:'text-gray-600 text-xs'},'Missing phones'),
                  React.createElement('ul',{className:'list-disc list-inside'}, results.missing.map((pid,i)=> React.createElement('li',{key:i}, (rosterById[pid]?.fullName)||pid)))
                ])
              ) : React.createElement('div',{className:'text-green-700'},'No missing phones detected'),
              (results && results.mismatched && results.mismatched.length) ? (
                React.createElement('div',{},[
                  React.createElement('div',{className:'text-gray-600 text-xs'},'Possible mismatches'),
                  React.createElement('ul',{className:'list-disc list-inside'}, results.mismatched.map((m,i)=> React.createElement('li',{key:i}, `${(rosterById[m.personId]?.fullName)||m.personId} — sim ${m.sim.toFixed(2)} at slot ${m.slot}`)))
                ])
              ) : React.createElement('div',{className:'text-gray-700'},'No mismatches flagged')
            ])
          ])
        ])
      ]),

      React.createElement('div',{className:'card text-xs text-gray-500 space-y-2'},[
        React.createElement('div',{className:'font-semibold'},'Data export/import'),
        React.createElement('div',{className:'flex flex-wrap items-center gap-2 text-sm'},[
          React.createElement('button',{className:'btn btn-primary',onClick:()=>downloadJson('phone-box-data.json',{grid, roster, assignments, gallery, corners, currentBox})},'Export JSON'),
          (()=>{ const label = React.createElement('label',{className:'btn'},['Import JSON', React.createElement('input',{type:'file',accept:'application/json',className:'hidden',onChange:e=>{ const f=e.target.files?.[0]; if(!f) return; const r=new FileReader(); r.onload=()=>{ try{ const obj=JSON.parse(String(r.result)); setRoster(obj.roster||[]); setGrid(obj.grid||DEFAULT_GRID); setAssignments(obj.assignments||{}); setGallery(obj.gallery||{}); setCorners(obj.corners||[]); setCurrentBox(obj.currentBox||''); }catch{ alert('Invalid JSON'); } }; r.readAsText(f); }}) ]); return label; })(),
          React.createElement('div',{},'All data stays in your browser unless you export it.')
        ])
      ])
    ]);
  }

  ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
  </script>

  <!--
  README (short):
  - Place roster.csv at repo root. Headers: Person ID,Full Name,Security Number,Current Grade,Email 1
  - Security Number parsing supports: 9B11, 10F7, 12C42, SM112, SM1-12, SM1 12 (prefix = box, trailing digits = slot 1–60)
  - On mobile, the file input uses capture="environment" to open the rear camera.
  - Use the Box dropdown (auto-built from roster) and the "Auto‑assign from Security #" button to map slots instantly.
  - Keep your repo private to protect student data.
  -->
</body>
</html>
